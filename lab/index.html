<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="styles/index.css">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"> </script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgpu/dist/tf-backend-webgpu.js"></script>
  </head>

  <body class="open-sans">
    <script src="scripts/activateGPT.js" type="module" defer></script>
    <h1> jsGPT Lab </h1>
    <h3> Experiment with jsGPT, an implementation of NanoGPT written in TensorflowJS! </h3>
    <p> Tune the hyperparameters below to your liking and hit "train" to train our NanoGPT model on Shakespeare's <i><a href="./data.txt">The Tragedy of Coriolanus</a></i>. Over time, you should see a fairly significant improvement in output quality, as the model learns to mimic the Shakespearean writing style. If you'd like to learn more about the training pipeline and the role of each hyperparameter, see <a href="./pipeline.html">this</a> page.</p>
    <p> Want to <a href="./bigram.html">try</a> a simpler model? </p>
    <p> <a href="./faq.html">What</a> is jsGPT? </p>
    <form id="gpt-form" class="form">
      <div>
        <label for="batch-size">Batch Size:</label>
        <input id="batch-size" name="batch-size" type="number" value="12"/>
      </div>
      <div>
        <label for="block-size">Block Size:</label>
        <input id="block-size" name="block-size" type="number" value="64"/>
      </div>
      <div>
        <label for="learning-rate">Learning Rate:</label>
        <input id="learning-rate" name="learning-rate" type="number" value="0.0003"/>
      </div>
      <div>
        <label for="eval-itvl">Eval Interval:</label>
        <input id="eval-itvl" name="eval-itvl" type="number" value="100"/>
      </div>
      <div>
        <label for="n-embd">Number of Embeddings:</label>
        <input id="n-embd" name="n-embd" type="number" value="128"/>
      </div>
      <div>
        <label for="n-layer">Number of Layers:</label>
        <input id="n-layer" name="n-layer" type="number" value="4"/>
      </div>
      <div>
        <label for="n-head">Number of Heads:</label>
        <input id="n-head" name="n-head" type="number" value="4"/>
      </div>
      <div>
        <label for="head-size">Head Size:</label>
        <input id="head-size" name="head-size" type="number" value="16"/>
      </div>
      <div>
        <label for="dropout">Dropout:</label>
        <input id="dropout" name="dropout" type="number" value="0.0"/>
      </div>
      <div>
        <label for="max-iters">Max Iterations:</label>
        <input id="max-iters" name="max-iters" type="number" value="200"/>
      </div>
      <input type="submit" value="TRAIN" id="train-button">
    </form>
    <div id="loss-display">
    </div>
    <div id="sample-display">
    </div>
  </body>
</html>
